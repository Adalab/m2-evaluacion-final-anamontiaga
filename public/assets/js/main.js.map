{"version":3,"sources":["main.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"main.js","sourcesContent":["\"use strict\";\n\n// 1º\nconst btn = document.querySelector(\".page__search--button\");\nconst listFilms = document.querySelector(\".page__results\");\nconst favFilmContainer = document.querySelector(\".page__favorites__films\");\nconst resetBtn = document.querySelectorAll(\".page__favorites__films--btn\");\n\nlet favFilms = [];\nlet searchedFilms = [];\n\n// LOCAL STORAGE\n\nfunction saveData() {\n  localStorage.setItem(\"favfilms\", JSON.stringify(favFilms));\n}\n\n// Si en el LS hay algo, me lo metes en el array de nuevo, osea, me los dejas ahí\nfunction catchData() {\n  const catchInfo = JSON.parse(localStorage.getItem(\"favfilms\"));\n  if (catchInfo !== null) {\n    favFilms = catchInfo;\n    paintFavs(); // y me los vuelves a pintar\n  }\n}\n\n// 5º Añadimos clase en el filme que pinchamos para cambiar color y generamos un índice para meter los filmes en el array de favFilms.\n// Además los pintamos e la lista de favoritos\n// Además salvamos los datos\nfunction handleFav(event) {\n  const currentFilm = event.currentTarget;\n  const clickedIndex = parseInt(currentFilm.dataset.index);\n  favFilms.push(searchedFilms[clickedIndex]);\n\n  currentFilm.classList.toggle(\"film--is--favorite\");\n\n  paintFavs();\n\n  saveData(favFilms);\n}\n\n// 6º Pintamos los favoritos, leyendo el array de favoritos\nfunction paintFavs() {\n  let htmlFavCode = \"\";\n\n  for (const favFilm of favFilms) {\n    htmlFavCode += `<li class=\"page__favorites__films--item\"><button class=\"page__favorites__films--btn\">x</button><img src=\"${favFilm.show.image}\" alt=\"${favFilm.show.name}\" class=\"page__favorites__films--image\"><h3 class=\"page__favorites__films--name\">${favFilm.show.name}</h3></li>`;\n  }\n\n  favFilmContainer.innerHTML = htmlFavCode;\n}\n\nfunction resetFav() {\n  const currentFavFilm = event.currentTarget;\n  const favFilm = document.querySelectorAll(\".page__favorites__films--item\");\n  if (currentFavFilm.classList.contains(\"page__favorites__films--item\") === true) {\n    if (favFilmContainer.includes(currentFavFilm) === true) {\n      currentFavFilm.style = \"display:none;\";\n    }\n  }\n}\n\n// 4ª cambiamos el color a los filmes clickados( al <li> y al <h3>)\nfunction activateFavs() {\n  const films = document.querySelectorAll(\".page__results--list\");\n  const filmsTitles = document.querySelectorAll(\".page__results--name\");\n\n  for (const film of films) {\n    film.addEventListener(\"click\", handleFav);\n  }\n  for (const title of filmsTitles) {\n    title.parentElement.addEventListener(\"click\", handleFav);\n  }\n}\n// 2º\nconst getFilm = function() {\n  let inputFilm = document.querySelector(\".page__search--film\");\n  inputFilm = inputFilm.value;\n  return `http://api.tvmaze.com/search/shows?q=${inputFilm}`;\n};\n\n// 3º\n\nconst getFilmInfo = function(ev) {\n  ev.preventDefault();\n  fetch(getFilm())\n    .then(response => response.json())\n    .then(data => {\n      listFilms.innerHTML = \"\";\n\n      for (let i = 0; i < data.length; i++) {\n        if (data[i].show.image === null) {\n          data[i].show.image = \"https://via.placeholder.com/210x295/ffffff/666666/?text=TV\";\n        } else {\n          data[i].show.image = data[i].show.image.medium;\n        }\n\n        listFilms.innerHTML += `<li class=\"page__results--list\" data-index=\"${i}\"><img src=\"${data[i].show.image}\" alt=\"${data[i].show.name}\" class=\"page__results--image\"><h3 class=\"page__results--name\">${data[i].show.name}</h3></li>`;\n      }\n      searchedFilms = data;\n      activateFavs();\n    });\n};\n\ncatchData();\n\nbtn.addEventListener(\"click\", getFilmInfo);\n\nresetBtn.addEventListener(\"click\", resetFav);\n"]}