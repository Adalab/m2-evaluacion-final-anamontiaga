"use strict";const btn=document.querySelector(".page__search--button"),listFilms=document.querySelector(".page__results"),favFilmContainer=document.querySelector(".page__favorites__films");let favFilms=[],searchedFilms=[];function saveData(){localStorage.setItem("favfilms",JSON.stringify(favFilms))}function catchData(){const e=JSON.parse(localStorage.getItem("favfilms"));null!==e&&(favFilms=e,paintFavs())}function handleFav(e){const t=e.currentTarget,a=parseInt(t.dataset.index);!1===favFilms.includes(searchedFilms[a])&&favFilms.push(searchedFilms[a]),t.classList.toggle("film--is--favorite"),paintFavs(),saveData()}function paintFavs(){let e="";for(let t=0;t<favFilms.length;t++)e+=`<li class="page__favorites__films--item" data-index="${t}"><button class="page__favorites__films--btn" data-index="${t}">x</button><img src="${favFilms[t].show.image}" alt="${favFilms[t].show.name}" class="page__favorites__films--image"><h3 class="page__favorites__films--name">${favFilms[t].show.name}</h3></li>`;favFilmContainer.innerHTML=e,activeRemoveFav()}function removeFav(e){let t=parseInt(e.currentTarget.dataset.index);favFilms.splice(t,1),paintFavs(),saveData()}function activateFavs(){const e=document.querySelectorAll(".page__results--list"),t=document.querySelectorAll(".page__results--name");for(const t of e)t.addEventListener("click",handleFav);for(const e of t)e.parentElement.addEventListener("click",handleFav)}const getFilm=function(){let e=document.querySelector(".page__search--film");return`http://api.tvmaze.com/search/shows?q=${e=e.value}`},getFilmInfo=function(e){e.preventDefault(),fetch(getFilm()).then(e=>e.json()).then(e=>{listFilms.innerHTML="";for(let t=0;t<e.length;t++)null===e[t].show.image?e[t].show.image="https://via.placeholder.com/210x295/ffffff/666666/?text=TV":e[t].show.image=e[t].show.image.medium,listFilms.innerHTML+=`<li class="page__results--list" data-index="${t}"><img src="${e[t].show.image}" alt="${e[t].show.name}" class="page__results--image"><h3 class="page__results--name">${e[t].show.name}</h3></li>`;searchedFilms=e,activateFavs()})};function activeRemoveFav(){const e=document.querySelectorAll(".page__favorites__films--btn");for(const t of e)t.addEventListener("click",removeFav)}catchData(),btn.addEventListener("click",getFilmInfo);